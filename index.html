<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Construction Estimator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            height: 100vh;
            overflow: hidden;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .scrollable-content {
            height: calc(100vh - 0px);
            overflow-y: auto;
        }
        .material-card {
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
        }
        .material-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .material-card.selected {
            border: 2px solid #059669;
            background-color: #f0fdf4;
        }
        .grade-btn {
            border: 1px solid #d1d5db;
            background: white;
        }
        .grade-btn.selected {
            background-color: #1f2937;
            color: white;
            border-color: #1f2937;
        }
        .brand-card {
            border: 1px solid #d1d5db;
            transition: all 0.2s ease;
        }
        .brand-card.selected {
            border: 2px solid #1f2937;
        }
        .cart-tag {
            background-color: #374151;
            color: white;
            font-size: 11px;
        }
        .green-check {
            background-color: #10b981;
            color: white;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            font-size: 10px;
        }
        
        /* Custom dropdown styling */
        .custom-select {
            position: relative;
        }
        .custom-select select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            padding-right: 40px;
        }
        .custom-select select:focus {
            outline: none;
            ring: 2px;
            ring-color: #3b82f6;
            border-color: #3b82f6;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="h-full flex">
        <!-- Left Panel - Main Content -->
        <div class="flex-1 scrollable-content">
            <div class="p-8">
                <!-- Header -->
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Home construction estimator</h1>
                    <p class="text-gray-600">Get an accurate estimate for your dream home in minutes</p>
                </div>

                <!-- Construction Details -->
                <div class="bg-gray-100 rounded-xl p-6 mb-8">
                    <h2 class="text-xl font-semibold text-gray-900 mb-6">Construction detail</h2>
                    
                    <div class="grid grid-cols-2 gap-8">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">Location in Rajasthan</label>
                            <div class="custom-select">
                                <select id="location" class="w-full p-3 bg-white border border-gray-300 rounded-lg text-gray-700 font-medium shadow-sm hover:border-gray-400 transition-colors">
                                    <option value="bikaner">Bikaner</option>
                                    <option value="jaipur">Jaipur</option>
                                    <option value="jodhpur">Jodhpur</option>
                                    <option value="udaipur">Udaipur</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">built-up area</label>
                            <div class="flex">
                                <input type="number" id="builtUpArea" value="2000" class="flex-1 p-3 bg-white border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <span class="bg-gray-200 border border-l-0 border-gray-300 rounded-r-lg px-4 py-3 text-gray-600 text-sm flex items-center">Sq.ft.</span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8">
                        <label class="block text-sm font-medium text-gray-700 mb-3">Number of floors</label>
                        <div class="flex items-center space-x-6">
                            <button id="decreaseFloors" class="w-8 h-8 border border-gray-400 rounded text-gray-600 hover:bg-gray-100 flex items-center justify-center text-lg">âˆ’</button>
                            <span id="floorCount" class="text-gray-700 min-w-0 flex-1">2 (ground+ 1st floor)</span>
                            <button id="increaseFloors" class="w-8 h-8 border border-gray-400 rounded text-gray-600 hover:bg-gray-100 flex items-center justify-center text-lg">+</button>
                        </div>
                    </div>

                    <button id="refreshBtn" class="mt-8 bg-black text-white px-8 py-3 rounded-lg hover:bg-gray-800 transition-colors flex items-center text-sm font-medium">
                        <span class="mr-2">ðŸ”„</span> Refresh
                    </button>
                </div>

                <!-- Materials Selection -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-900 mb-6">Select materials</h2>
                    
                    <!-- Material Categories -->
                    <div class="grid grid-cols-8 gap-4 mb-8">
                        <div class="material-card p-4 bg-white rounded-lg cursor-pointer text-center selected" data-material="steel">
                            <div class="w-12 h-12 mx-auto mb-3 bg-gray-100 rounded flex items-center justify-center relative">
                                <svg class="w-6 h-6 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2L2 7v10c0 5.55 3.84 9.36 9 10.93C16.16 26.36 20 22.55 20 17V7l-8-5z"/>
                                </svg>
                                <div class="green-check absolute -top-1 -right-1 flex items-center justify-center">âœ“</div>
                            </div>
                            <span class="text-xs text-gray-600 font-medium">TMT Steel</span>
                        </div>
                        
                        <div class="material-card p-4 bg-white rounded-lg cursor-pointer text-center selected" data-material="cement">
                            <div class="w-12 h-12 mx-auto mb-3 bg-amber-100 rounded flex items-center justify-center text-xs font-bold text-amber-800">
                                CEMENT
                            </div>
                            <span class="text-xs text-gray-600 font-medium">Cement</span>
                        </div>
                        
                        <div class="material-card p-4 bg-white rounded-lg cursor-pointer text-center" data-material="bricks">
                            <div class="w-12 h-12 mx-auto mb-3 bg-red-100 rounded flex items-center justify-center">
                                <div class="w-8 h-6 bg-red-400 rounded-sm"></div>
                            </div>
                            <span class="text-xs text-gray-600 font-medium">Bricks</span>
                        </div>
                        
                        <div class="material-card p-4 bg-white rounded-lg cursor-pointer text-center" data-material="sand">
                            <div class="w-12 h-12 mx-auto mb-3 bg-yellow-100 rounded flex items-center justify-center text-xs font-bold text-yellow-800">
                                SAND
                            </div>
                            <span class="text-xs text-gray-600 font-medium">Sand</span>
                        </div>
                        
                        <div class="material-card p-4 bg-white rounded-lg cursor-pointer text-center" data-material="electrical">
                            <div class="w-12 h-12 mx-auto mb-3 bg-gray-100 rounded flex items-center justify-center">
                                <svg class="w-6 h-6 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M14,2H10V7H8V9H10V14H8V16H10V21H14V16H16V14H14V9H16V7H14V2Z"/>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600 font-medium">Electrical</span>
                        </div>
                        
                        <div class="material-card p-4 bg-white rounded-lg cursor-pointer text-center" data-material="plumbing">
                            <div class="w-12 h-12 mx-auto mb-3 bg-blue-100 rounded flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12,2A3,3 0 0,1 15,5V8A3,3 0 0,1 12,11A3,3 0 0,1 9,8V5A3,3 0 0,1 12,2M12,4A1,1 0 0,0 11,5V8A1,1 0 0,0 12,9A1,1 0 0,0 13,8V5A1,1 0 0,0 12,4Z"/>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600 font-medium">Plumbing</span>
                        </div>
                        
                        <div class="material-card p-4 bg-white rounded-lg cursor-pointer text-center" data-material="flooring">
                            <div class="w-12 h-12 mx-auto mb-3 bg-gray-100 rounded flex items-center justify-center">
                                <div class="w-8 h-8 bg-gray-300 rounded border-2 border-gray-400"></div>
                            </div>
                            <span class="text-xs text-gray-600 font-medium">Flooring</span>
                        </div>
                        
                        <div class="material-card p-4 bg-white rounded-lg cursor-pointer text-center" data-material="doors">
                            <div class="w-12 h-12 mx-auto mb-3 bg-amber-100 rounded flex items-center justify-center">
                                <div class="w-6 h-8 bg-amber-400 rounded-sm border-r-2 border-amber-600"></div>
                            </div>
                            <span class="text-xs text-gray-600 font-medium">Door & wi...</span>
                        </div>
                    </div>

                    <!-- Material Configuration -->
                    <div class="bg-yellow-50 rounded-xl p-6">
                        <!-- Grade Selection -->
                        <div class="mb-8">
                            <label class="block text-sm font-medium text-gray-700 mb-3">Select Grade</label>
                            <div class="flex space-x-3">
                                <button class="grade-btn px-6 py-2 rounded-full text-sm font-medium selected">M20</button>
                                <button class="grade-btn px-6 py-2 rounded-full text-sm font-medium">M7.5</button>
                            </div>
                        </div>

                        <!-- Brand Selection -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">Select Brand</label>
                            <div class="grid grid-cols-4 gap-4">
                                <div class="brand-card bg-white rounded-lg p-4 cursor-pointer">
                                    <div class="w-16 h-16 mx-auto mb-3 bg-red-600 rounded flex items-center justify-center relative">
                                        <span class="text-white text-xs font-bold">ACC</span>
                                        <div class="absolute -top-1 -right-1 w-5 h-5 bg-gray-300 rounded-full flex items-center justify-center">
                                            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                                        </div>
                                    </div>
                                    <p class="text-center text-sm font-medium text-gray-700">ACC Cement</p>
                                </div>
                                
                                <div class="brand-card bg-white rounded-lg p-4 cursor-pointer">
                                    <div class="w-16 h-16 mx-auto mb-3 bg-yellow-600 rounded flex items-center justify-center relative">
                                        <span class="text-white text-xs font-bold">JSW</span>
                                        <div class="absolute -top-1 -right-1 w-5 h-5 bg-gray-300 rounded-full flex items-center justify-center">
                                            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                                        </div>
                                    </div>
                                    <p class="text-center text-sm font-medium text-gray-700">Ultratech</p>
                                </div>
                                
                                <div class="brand-card bg-white rounded-lg p-4 cursor-pointer">
                                    <div class="w-16 h-16 mx-auto mb-3 bg-yellow-400 rounded flex items-center justify-center relative">
                                        <span class="text-black text-xs font-bold">JSW</span>
                                        <div class="absolute -top-1 -right-1 w-5 h-5 bg-gray-300 rounded-full flex items-center justify-center">
                                            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                                        </div>
                                    </div>
                                    <p class="text-center text-sm font-medium text-gray-700">JSW Cement</p>
                                </div>
                                
                                <div class="brand-card bg-white rounded-lg p-4 cursor-pointer">
                                    <div class="w-16 h-16 mx-auto mb-3 bg-blue-600 rounded flex items-center justify-center relative">
                                        <span class="text-white text-xs font-bold">DALMIA</span>
                                        <div class="absolute -top-1 -right-1 w-5 h-5 bg-gray-300 rounded-full flex items-center justify-center">
                                            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                                        </div>
                                    </div>
                                    <p class="text-center text-sm font-medium text-gray-700">Dalmia Plus</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Added to Cart Section -->
                <div class="bg-black rounded-t-xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center text-white">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                            </svg>
                            <span class="font-medium">Added to cart</span>
                        </div>
                        <button id="calculateBtn" class="bg-white text-black px-6 py-2 rounded-lg hover:bg-gray-100 transition-colors text-sm font-medium flex items-center">
                            Calculate â†’
                        </button>
                    </div>
                    
                    <div class="flex space-x-2 overflow-x-auto" id="cartTags">
                        <span class="cart-tag px-3 py-1 rounded-full whitespace-nowrap flex items-center">
                            TATA Steel 
                            <button class="ml-2 text-gray-300 hover:text-white" onclick="removeCartItem('TATA Steel')">âœ•</button>
                        </span>
                        <button class="text-white hover:text-gray-300">â†’</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel - Summary -->
        <div class="w-80 bg-white border-l border-gray-200 p-6 flex flex-col">
            <div class="mb-8">
                <div class="w-24 h-24 mx-auto mb-6 bg-gradient-to-b from-amber-200 to-amber-300 rounded-xl flex items-center justify-center shadow-lg">
                    <div class="text-amber-800">
                        <div class="w-12 h-8 bg-amber-600 rounded-t mb-1"></div>
                        <div class="w-12 h-6 bg-amber-700 rounded-b"></div>
                        <div class="grid grid-cols-2 gap-1 mt-1">
                            <div class="w-2 h-2 bg-amber-900 rounded-sm"></div>
                            <div class="w-2 h-2 bg-amber-900 rounded-sm"></div>
                            <div class="w-2 h-2 bg-amber-900 rounded-sm"></div>
                            <div class="w-2 h-2 bg-amber-900 rounded-sm"></div>
                        </div>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div class="flex items-center">
                        <div class="w-6 h-6 bg-gray-200 rounded mr-3 flex items-center justify-center">
                            <svg class="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M3 17h18v2H3v-2zm0-5h18v2H3v-2zm0-5h18v2H3V7z"/>
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600">Total built-up area</p>
                            <p class="text-xl font-semibold text-gray-900" id="totalArea">4000 sq.ft.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center">
                        <div class="w-6 h-6 bg-gray-200 rounded mr-3 flex items-center justify-center">
                            <svg class="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2L2 7v10c0 5.55 3.84 9.36 9 10.93C16.16 26.36 20 22.55 20 17V7l-8-5z"/>
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-gray-600">Number of floors</p>
                            <p class="text-lg font-medium text-gray-900" id="totalFloors">Ground + 1st floor</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cost Summary -->
            <div class="flex-1 bg-blue-50 rounded-xl p-6">
                <h3 class="font-semibold text-gray-900 mb-4 text-lg">Cost Estimate</h3>
                <div class="space-y-3 text-sm">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Material Cost:</span>
                        <span class="font-medium text-gray-900" id="materialCost">â‚¹25,00,000</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Labor Cost:</span>
                        <span class="font-medium text-gray-900" id="laborCost">â‚¹29,00,000</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Management & Design:</span>
                        <span class="font-medium text-gray-900" id="managementCost">â‚¹24,90,000</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Miscellaneous (5%):</span>
                        <span class="font-medium text-gray-900" id="miscCost">â‚¹1,25,000</span>
                    </div>
                    <hr class="my-3 border-gray-300">
                    <div class="flex justify-between text-lg">
                        <span class="font-semibold text-gray-900">Total Cost:</span>
                        <span class="font-bold text-gray-900" id="totalCost">â‚¹80,15,000</span>
                    </div>
                    <p class="text-xs text-gray-500 mt-2">Per sq.ft: <span class="font-medium" id="perSqFtCost">â‚¹2,004</span></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Construction cost calculation data based on PDF
        const materialRates = {
            steel: {
                'TATA Steel': { rate: 75, unit: 'kg', perSqft: 3.5 },
                'Jindal Panther': { rate: 75, unit: 'kg', perSqft: 3.5 },
                'JSW Or Rathi': { rate: 70, unit: 'kg', perSqft: 3.5 }
            },
            cement: {
                'ACC Cement': { rate: 340, unit: 'bag', perSqft: 0.17 },
                'Ultratech': { rate: 340, unit: 'bag', perSqft: 0.17 },
                'JSW Cement': { rate: 320, unit: 'bag', perSqft: 0.17 },
                'Dalmia Plus': { rate: 320, unit: 'bag', perSqft: 0.17 }
            },
            bricks: {
                'Fly Ash bricks': { rate: 8, unit: 'nos', perSqft: 1 },
                'Red clay brick': { rate: 7, unit: 'nos', perSqft: 1 },
                'Kanota': { rate: 7, unit: 'nos', perSqft: 1 }
            },
            sand: {
                'River sand': { rate: 1250, unit: 'ton', perSqft: 0.05 },
                'M/E Sand': { rate: 900, unit: 'ton', perSqft: 0.05 },
                'Stone': { rate: 750, unit: 'ton', perSqft: 0.05 }
            },
            electrical: {
                'Shiva/Jindal': { rate: 20, unit: 'sqft', perSqft: 1 },
                'Other brands': { rate: 17, unit: 'sqft', perSqft: 1 }
            },
            plumbing: {
                'Ashirvad/Astral': { rate: 35, unit: 'sqft', perSqft: 1 },
                'Supreme/Prince': { rate: 30, unit: 'sqft', perSqft: 1 },
                'Kisan': { rate: 35, unit: 'sqft', perSqft: 1 }
            },
            flooring: {
                'Vitrified 50': { rate: 50, unit: 'sqft', perSqft: 1 },
                'Vitrified 80': { rate: 80, unit: 'sqft', perSqft: 1 },
                'Vitrified 120': { rate: 120, unit: 'sqft', perSqft: 1 }
            },
            doors: {
                'Door shutter 45': { rate: 45, unit: 'sqft', perSqft: 1 },
                'Door shutter 55': { rate: 55, unit: 'sqft', perSqft: 1 },
                'Door shutter 65': { rate: 65, unit: 'sqft', perSqft: 1 }
            }
        };

        let currentFloors = 2;
        let selectedMaterials = ['steel', 'cement'];
        let selectedBrands = {
            steel: 'TATA Steel',
            cement: null // Start with no cement brand selected
        };
        let cartItems = ['TATA Steel']; // Only TATA Steel initially
        let currentSelectedMaterial = 'cement'; // Track which material's brands are being shown

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
        });

        function setupEventListeners() {
            // Floor controls
            document.getElementById('decreaseFloors').addEventListener('click', () => {
                if (currentFloors > 1) {
                    currentFloors--;
                    updateFloorDisplay();
                }
            });

            document.getElementById('increaseFloors').addEventListener('click', () => {
                if (currentFloors < 5) {
                    currentFloors++;
                    updateFloorDisplay();
                }
            });

            // Built-up area input
            document.getElementById('builtUpArea').addEventListener('input', updateFloorDisplay);

            // Material selection
            document.querySelectorAll('.material-card').forEach(card => {
                card.addEventListener('click', function() {
                    const material = this.dataset.material;
                    this.classList.toggle('selected');
                    
                    if (this.classList.contains('selected')) {
                        if (!selectedMaterials.includes(material)) {
                            selectedMaterials.push(material);
                            
                            // If selecting cement, only show it's selected but don't auto-select brand
                            if (material === 'cement') {
                                // Material is selected but no brand chosen yet
                                // User needs to explicitly choose a brand
                            }
                            
                            addToCart(material);
                        }
                    } else {
                        selectedMaterials = selectedMaterials.filter(m => m !== material);
                        removeFromCart(material);
                        
                        // If deselecting cement, clear brand selection
                        if (material === 'cement') {
                            selectedBrands.cement = null;
                            document.querySelectorAll('.brand-card').forEach(card => {
                                card.classList.remove('selected');
                            });
                        }
                    }
                    updateCartDisplay();
                });
            });

            // Brand selection
            document.querySelectorAll('.brand-card').forEach(card => {
                card.addEventListener('click', function() {
                    const brandName = this.querySelector('p').textContent;
                    const isCurrentlySelected = this.classList.contains('selected');
                    
                    // If clicking the same brand, deselect it (allow empty selection)
                    if (isCurrentlySelected) {
                        this.classList.remove('selected');
                        selectedBrands[currentSelectedMaterial] = null;
                        
                        // Remove from cart if material is selected
                        if (selectedMaterials.includes(currentSelectedMaterial)) {
                            cartItems = cartItems.filter(item => item !== brandName);
                            updateCartDisplay();
                        }
                    } else {
                        // Deselect all other brands
                        document.querySelectorAll('.brand-card').forEach(c => c.classList.remove('selected'));
                        // Select this brand
                        this.classList.add('selected');
                        
                        const oldBrand = selectedBrands[currentSelectedMaterial];
                        selectedBrands[currentSelectedMaterial] = brandName;
                        
                        // Update cart if material is selected
                        if (selectedMaterials.includes(currentSelectedMaterial)) {
                            // Remove old brand from cart if it exists
                            if (oldBrand) {
                                cartItems = cartItems.filter(item => item !== oldBrand);
                            }
                            // Add new brand to cart
                            if (!cartItems.includes(brandName)) {
                                cartItems.push(brandName);
                            }
                            updateCartDisplay();
                        }
                    }
                });
            });

            // Grade selection
            document.querySelectorAll('.grade-btn').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.grade-btn').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });

            // Calculate button
            document.getElementById('calculateBtn').addEventListener('click', function() {
                updateCalculations();
                this.innerHTML = 'Calculating...';
                setTimeout(() => {
                    this.innerHTML = 'Calculate â†’';
                }, 1000);
            });

            // Refresh button
            document.getElementById('refreshBtn').addEventListener('click', function() {
                updateCalculations();
                this.innerHTML = '<span class="mr-2">ðŸ”„</span> Refreshing...';
                setTimeout(() => {
                    this.innerHTML = '<span class="mr-2">ðŸ”„</span> Refresh';
                }, 500);
            });
        }

        function updateFloorDisplay() {
            const floorNames = {
                1: 'Ground floor',
                2: 'Ground + 1st floor',
                3: 'Ground + 1st + 2nd floor',
                4: 'Ground + 1st + 2nd + 3rd floor',
                5: 'Ground + 1st + 2nd + 3rd + 4th floor'
            };
            
            document.getElementById('floorCount').textContent = `${currentFloors} (${floorNames[currentFloors]})`;
            document.getElementById('totalFloors').textContent = floorNames[currentFloors];
            
            // Update total area display
            const groundFloorArea = parseInt(document.getElementById('builtUpArea').value) || 2000;
            const totalArea = groundFloorArea * currentFloors;
            document.getElementById('totalArea').textContent = `${totalArea.toLocaleString()} sq.ft.`;
        }

        function updateCalculations() {
            const groundFloorArea = parseInt(document.getElementById('builtUpArea').value) || 2000;
            const totalArea = groundFloorArea * currentFloors;
            
            // Calculate costs based on selected materials and their brands
            let materialCost = 0;
            
            // Calculate cost for each selected material
            selectedMaterials.forEach(material => {
                const brand = selectedBrands[material];
                
                // Only calculate if brand is selected and exists in rates
                if (brand && materialRates[material] && materialRates[material][brand]) {
                    const rate = materialRates[material][brand];
                    const quantity = totalArea * rate.perSqft;
                    materialCost += quantity * rate.rate;
                } else if (material && materialRates[material]) {
                    // Use first available brand as fallback
                    const firstBrand = Object.keys(materialRates[material])[0];
                    if (firstBrand) {
                        const rate = materialRates[material][firstBrand];
                        const quantity = totalArea * rate.perSqft;
                        materialCost += quantity * rate.rate;
                    }
                }
            });
            
            // Add base construction costs from PDF
            const waterProofing = 40 * totalArea * 0.3; // â‚¹40 per sqft, 0.3 factor
            const termiteSolution = 15 * totalArea * 0.9; // â‚¹15 per sqft, 0.9 factor
            const mixConcrete = 4000 * totalArea * 0.04; // M20 concrete
            const pccCost = 2800 * totalArea * 0.012; // PCC M7.5
            
            materialCost += waterProofing + termiteSolution + mixConcrete + pccCost;
            
            // Calculate other costs as per PDF
            const laborCost = totalArea * 290; // â‚¹290 per sqft for labor
            const managementCost = totalArea * 249; // â‚¹249 per sqft for management
            const miscCost = materialCost * 0.05; // 5% of material cost
            
            const totalCost = materialCost + laborCost + managementCost + miscCost;
            const perSqFtCost = totalCost / totalArea;
            
            // Update cost display
            document.getElementById('materialCost').textContent = `â‚¹${(materialCost/100000).toFixed(1)}L`;
            document.getElementById('laborCost').textContent = `â‚¹${(laborCost/100000).toFixed(1)}L`;
            document.getElementById('managementCost').textContent = `â‚¹${(managementCost/100000).toFixed(1)}L`;
            document.getElementById('miscCost').textContent = `â‚¹${(miscCost/100000).toFixed(1)}L`;
            document.getElementById('totalCost').textContent = `â‚¹${(totalCost/100000).toFixed(1)}L`;
            document.getElementById('perSqFtCost').textContent = `â‚¹${Math.round(perSqFtCost)}`;
        }

        // Initialize display
        updateFloorDisplay();
        updateCartDisplay();
        
        // Set initial cost display to show placeholder values
        document.getElementById('materialCost').textContent = 'â‚¹--';
        document.getElementById('laborCost').textContent = 'â‚¹--';
        document.getElementById('managementCost').textContent = 'â‚¹--';
        document.getElementById('miscCost').textContent = 'â‚¹--';
        document.getElementById('totalCost').textContent = 'â‚¹--';
        document.getElementById('perSqFtCost').textContent = 'â‚¹--';

        function getCurrentSelectedMaterial() {
            // Return the currently active material (cement in this case since it's shown)
            return 'cement';
        }

        function addToCart(material) {
            // Only add to cart if material has a selected brand or is not brand-dependent
            if (material === 'cement' || material === 'steel') {
                const brandName = selectedBrands[material];
                if (brandName && !cartItems.includes(brandName)) {
                    cartItems.push(brandName);
                }
            } else {
                // For non-brand materials, use material name with default options
                const materialNames = {
                    bricks: 'Fly Ash bricks',
                    sand: 'River sand',
                    electrical: 'Shiva/Jindal',
                    plumbing: 'Ashirvad/Astral',
                    flooring: 'Vitrified 50',
                    doors: 'Door shutter 45'
                };
                const itemName = materialNames[material];
                if (itemName && !cartItems.includes(itemName)) {
                    cartItems.push(itemName);
                    // Set default brand for non-brand materials
                    selectedBrands[material] = itemName;
                }
            }
        }

        function removeFromCart(material) {
            if (material === 'cement' || material === 'steel') {
                const brandName = selectedBrands[material];
                if (brandName) {
                    cartItems = cartItems.filter(item => item !== brandName);
                }
            } else {
                const materialNames = {
                    bricks: 'Fly Ash bricks',
                    sand: 'River sand',
                    electrical: 'Shiva/Jindal',
                    plumbing: 'Ashirvad/Astral',
                    flooring: 'Vitrified 50',
                    doors: 'Door shutter 45'
                };
                const itemName = materialNames[material];
                if (itemName) {
                    cartItems = cartItems.filter(item => item !== itemName);
                    selectedBrands[material] = null;
                }
            }
        }

        function removeCartItem(itemName) {
            cartItems = cartItems.filter(item => item !== itemName);
            
            // Also remove from selected materials
            const materialMap = {
                'TATA Steel': 'steel',
                'ACC Cement': 'cement',
                'Ultratech': 'cement',
                'JSW Cement': 'cement',
                'Dalmia Plus': 'cement',
                'Bricks': 'bricks',
                'Sand': 'sand',
                'Electrical': 'electrical',
                'Plumbing': 'plumbing',
                'Flooring': 'flooring',
                'Doors & Windows': 'doors'
            };
            
            const material = materialMap[itemName];
            if (material) {
                selectedMaterials = selectedMaterials.filter(m => m !== material);
                // Update UI - remove material selection
                const materialCard = document.querySelector(`[data-material="${material}"]`);
                if (materialCard) {
                    materialCard.classList.remove('selected');
                }
                
                // If removing cement or steel brand, clear brand selection
                if (material === 'cement' || material === 'steel') {
                    selectedBrands[material] = null; // Set to null instead of default
                    // Deselect all brand cards
                    document.querySelectorAll('.brand-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                }
            }
            
            updateCartDisplay();
            updateCalculations();
        }

        function updateCartDisplay() {
            const cartContainer = document.getElementById('cartTags');
            cartContainer.innerHTML = '';
            
            cartItems.forEach(item => {
                const tag = document.createElement('span');
                tag.className = 'cart-tag px-3 py-1 rounded-full whitespace-nowrap flex items-center';
                tag.innerHTML = `
                    ${item}
                    <button class="ml-2 text-gray-300 hover:text-white" onclick="removeCartItem('${item}')">âœ•</button>
                `;
                cartContainer.appendChild(tag);
            });
            
            // Add arrow if there are items
            if (cartItems.length > 0) {
                const arrow = document.createElement('button');
                arrow.className = 'text-white hover:text-gray-300';
                arrow.textContent = 'â†’';
                cartContainer.appendChild(arrow);
            }
        }
    </script>
</body>
</html>
